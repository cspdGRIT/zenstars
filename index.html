<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZenStars - AI-Powered Community Challenges</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #2d3748;
            overflow-x: hidden;
            background: #f7fafc;
        }

        .hero {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            color: white;
            padding: 120px 20px 80px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '‚ö°‚ú®üèÜüé®üí™';
            position: absolute;
            font-size: 120px;
            opacity: 0.1;
            top: 5%;
            left: 5%;
            animation: float 8s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-40px) rotate(10deg); }
        }

        .hero h1 {
            font-size: 4.5em;
            margin-bottom: 20px;
            font-weight: 800;
            animation: fadeInUp 0.8s ease-out;
        }

        .hero .tagline {
            font-size: 1.6em;
            margin-bottom: 15px;
            opacity: 0.95;
            animation: fadeInUp 0.8s ease-out 0.2s backwards;
        }

        .ai-badge {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(10px);
            padding: 15px 35px;
            border-radius: 50px;
            display: inline-block;
            margin: 20px 0;
            font-size: 1.2em;
            font-weight: 600;
            border: 2px solid rgba(255, 255, 255, 0.3);
            animation: fadeInUp 0.8s ease-out 0.4s backwards;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .hero-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 40px;
            animation: fadeInUp 0.8s ease-out 0.6s backwards;
        }

        .btn {
            padding: 16px 40px;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: white;
            color: #667eea;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        }

        .btn-secondary {
            background: transparent;
            color: white;
            border: 2px solid white;
        }

        .btn-secondary:hover {
            background: white;
            color: #667eea;
            transform: translateY(-3px);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 80px 20px;
        }

        .section-title {
            text-align: center;
            font-size: 2.8em;
            margin-bottom: 20px;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .section-subtitle {
            text-align: center;
            font-size: 1.2em;
            color: #718096;
            margin-bottom: 60px;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        .ai-generator {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            padding: 80px 20px;
        }

        .generator-container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 50px;
            border-radius: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
        }

        .generator-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .option-btn {
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .option-btn.active {
            background: linear-gradient(135deg, #f5576c 0%, #ff9a56 100%);
            box-shadow: 0 10px 30px rgba(245, 87, 108, 0.3);
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #2d3748;
        }

        .input-group input,
        .input-group select,
        .input-group textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1em;
            transition: all 0.3s;
            font-family: inherit;
        }

        .input-group input:focus,
        .input-group select:focus,
        .input-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .generate-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 1.2em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .generate-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
        }

        .generate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .result-box {
            margin-top: 30px;
            padding: 30px;
            background: #f7fafc;
            border-radius: 15px;
            border: 2px solid #e2e8f0;
            display: none;
        }

        .result-box.visible {
            display: block;
            animation: slideIn 0.5s;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .result-box h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .result-content {
            color: #2d3748;
            line-height: 1.8;
            white-space: pre-wrap;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .api-settings {
            background: #f7fafc;
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 40px;
            border: 2px solid #e2e8f0;
        }

        .api-settings h3 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .api-provider {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .provider-btn {
            padding: 12px 25px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .provider-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .api-note {
            padding: 15px;
            background: #fef3c7;
            border-radius: 10px;
            border-left: 4px solid #f59e0b;
            color: #92400e;
            font-size: 0.9em;
            margin-top: 15px;
        }

        .success-note {
            padding: 15px;
            background: #d1fae5;
            border-radius: 10px;
            border-left: 4px solid #10b981;
            color: #065f46;
            font-size: 0.9em;
            margin-top: 15px;
        }

        .error-note {
            padding: 15px;
            background: #fee2e2;
            border-radius: 10px;
            border-left: 4px solid #ef4444;
            color: #991b1b;
            font-size: 0.9em;
            margin-top: 15px;
        }

        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .category-card {
            background: white;
            padding: 40px 30px;
            border-radius: 20px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.08);
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
            border: 3px solid transparent;
        }

        .category-card:hover {
            transform: translateY(-10px);
            border-color: #667eea;
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.15);
        }

        .category-icon {
            font-size: 4em;
            margin-bottom: 20px;
        }

        .category-title {
            font-size: 1.4em;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 10px;
        }

        .category-desc {
            color: #718096;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .status-badge {
            display: inline-block;
            padding: 8px 20px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .status-badge.coming-soon {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }

        .footer {
            background: #2d3748;
            color: white;
            padding: 50px 20px;
            text-align: center;
        }

        .footer p {
            margin: 12px 0;
            opacity: 0.9;
        }

        .floating-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 16px 32px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 700;
            font-size: 1.1em;
            box-shadow: 0 10px 40px rgba(245, 87, 108, 0.4);
            transition: all 0.3s ease;
            animation: pulse 2s infinite;
        }

        .floating-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 15px 50px rgba(245, 87, 108, 0.6);
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 10px 40px rgba(245, 87, 108, 0.4); }
            50% { box-shadow: 0 10px 40px rgba(245, 87, 108, 0.7); }
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .action-buttons button {
            flex: 1;
        }

        @media (max-width: 768px) {
            .hero h1 { font-size: 2.5em; }
            .section-title { font-size: 2em; }
            .generator-container { padding: 30px 20px; }
            .categories-grid { grid-template-columns: 1fr; }
            .floating-btn { bottom: 20px; right: 20px; padding: 12px 24px; font-size: 0.95em; }
            .api-provider { flex-direction: column; }
            .action-buttons { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="hero">
        <div style="max-width: 900px; margin: 0 auto; position: relative; z-index: 1;">
            <h1>‚ö° ZENSTARS ‚ö°</h1>
            <p class="tagline">AI-Powered Community Challenges That Ignite Your Spirit</p>
            <div class="ai-badge">ü§ñ Powered by Open-Source LLMs</div>
            <p style="font-size: 1.15em; margin-top: 20px; opacity: 0.95;">Generate unlimited challenges, get AI tips, and compete with your community!</p>
            <div class="hero-buttons">
                <button class="btn btn-primary" onclick="scrollToGenerator()">üöÄ Generate Challenge</button>
                <button class="btn btn-secondary" onclick="scrollToChallenges()">üèÜ View Challenges</button>
            </div>
        </div>
    </div>

    <div class="ai-generator" id="generator">
        <div class="container">
            <h2 class="section-title">ü§ñ AI Challenge Generator</h2>
            <p class="section-subtitle">Let AI create personalized challenges based on your preferences</p>
            
            <div class="generator-container">
                <div class="api-settings">
                    <h3>‚öôÔ∏è AI Provider Settings</h3>
                    <div class="api-provider">
                        <button class="provider-btn active" data-provider="groq">Groq (Fast & Free)</button>
                        <button class="provider-btn" data-provider="huggingface">HuggingFace</button>
                        <button class="provider-btn" data-provider="together">Together AI</button>
                    </div>
                    <div class="input-group">
                        <label>API Key (Optional - Get from provider's website)</label>
                        <input type="password" id="apiKey" placeholder="Enter your API key for better rate limits">
                    </div>
                    <div class="api-note">
                        üí° <strong>Free Access:</strong> All providers offer free tiers. For unlimited use, sign up and add your API key above.
                        <br><br>
                        <strong>Get API Keys:</strong><br>
                        ‚Ä¢ Groq: <a href="https://console.groq.com" target="_blank" style="color: #667eea;">console.groq.com</a><br>
                        ‚Ä¢ HuggingFace: <a href="https://huggingface.co/settings/tokens" target="_blank" style="color: #667eea;">huggingface.co/settings/tokens</a><br>
                        ‚Ä¢ Together: <a href="https://api.together.xyz" target="_blank" style="color: #667eea;">api.together.xyz</a>
                    </div>
                </div>

                <div class="generator-options">
                    <button class="option-btn active" data-mode="new">‚ú® New Challenge</button>
                    <button class="option-btn" data-mode="variation">üîÑ Variation</button>
                    <button class="option-btn" data-mode="tips">üí° Get Tips</button>
                    <button class="option-btn" data-mode="judging">‚öñÔ∏è Judging Criteria</button>
                </div>

                <div id="inputFields">
                    <div class="input-group">
                        <label>Challenge Category</label>
                        <select id="category">
                            <option value="art">üé® Art & Craft</option>
                            <option value="fitness">üí™ Fitness</option>
                            <option value="cooking">üç≥ Cooking</option>
                            <option value="home">üè† Home & Garden</option>
                            <option value="performance">üé≠ Performance</option>
                            <option value="treasure">üó∫Ô∏è Treasure Hunt</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>Difficulty Level</label>
                        <select id="difficulty">
                            <option value="easy">Easy (Everyone can try)</option>
                            <option value="medium">Medium (Some skill needed)</option>
                            <option value="hard">Hard (Expert level)</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>Duration</label>
                        <select id="duration">
                            <option value="quick">Quick (Under 1 hour)</option>
                            <option value="medium">Medium (1-3 hours)</option>
                            <option value="long">Long (3+ hours or multi-day)</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>Additional Requirements (Optional)</label>
                        <textarea id="requirements" rows="3" placeholder="E.g., Use only eco-friendly materials, Indoor activity, Family-friendly, etc."></textarea>
                    </div>
                </div>

                <button class="generate-btn" id="generateBtn">
                    <span>üöÄ</span>
                    <span>Generate with AI</span>
                </button>

                <div class="result-box" id="resultBox">
                    <h3 id="resultTitle">Generated Challenge</h3>
                    <div class="result-content" id="resultContent"></div>
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="saveChallenge()">üíæ Save Challenge</button>
                        <button class="btn btn-secondary" onclick="shareChallenge()">üì§ Share</button>
                        <button class="btn btn-secondary" onclick="regenerate()">üîÑ Regenerate</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container" id="challenges">
        <h2 class="section-title">üéØ Challenge Categories</h2>
        <p class="section-subtitle">Pick your passion and start competing today!</p>
        
        <div class="categories-grid">
            <div class="category-card">
                <div class="category-icon">üé®</div>
                <h3 class="category-title">Art & Craft</h3>
                <p class="category-desc">Rangoli, Drawing, DIY Projects, Creative Crafts</p>
                <span class="status-badge">Active Now</span>
            </div>

            <div class="category-card">
                <div class="category-icon">üí™</div>
                <h3 class="category-title">Fitness</h3>
                <p class="category-desc">Plank, Yoga, Running, Sports Challenges</p>
                <span class="status-badge">Active Now</span>
            </div>

            <div class="category-card">
                <div class="category-icon">üç≥</div>
                <h3 class="category-title">Cooking</h3>
                <p class="category-desc">Recipe Creation, Baking, Speed Cooking</p>
                <span class="status-badge coming-soon">Coming Soon</span>
            </div>

            <div class="category-card">
                <div class="category-icon">üè†</div>
                <h3 class="category-title">Home & Garden</h3>
                <p class="category-desc">Organization, Gardening, Home Decor</p>
                <span class="status-badge coming-soon">Coming Soon</span>
            </div>

            <div class="category-card">
                <div class="category-icon">üé≠</div>
                <h3 class="category-title">Performance</h3>
                <p class="category-desc">Dance, Music, Storytelling, Drama</p>
                <span class="status-badge coming-soon">Coming Soon</span>
            </div>

            <div class="category-card">
                <div class="category-icon">üó∫Ô∏è</div>
                <h3 class="category-title">Treasure Hunt</h3>
                <p class="category-desc">Solve clues, find treasures, win big!</p>
                <span class="status-badge">Special Event</span>
            </div>
        </div>
    </div>

    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 80px 20px; color: white;">
        <div class="container">
            <h2 class="section-title" style="color: white; -webkit-text-fill-color: white;">ü§ñ How AI Powers ZenStars</h2>
            <p class="section-subtitle" style="color: rgba(255,255,255,0.9);">Open-source LLMs make every challenge unique and engaging</p>
            
            <div class="categories-grid" style="margin-top: 40px;">
                <div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); padding: 30px; border-radius: 20px; border: 2px solid rgba(255,255,255,0.2);">
                    <div style="font-size: 3em; margin-bottom: 15px;">‚ú®</div>
                    <h3 style="font-size: 1.4em; margin-bottom: 15px;">Challenge Generation</h3>
                    <p style="opacity: 0.95; line-height: 1.7;">AI creates unlimited unique challenges based on category, difficulty, and community preferences</p>
                </div>

                <div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); padding: 30px; border-radius: 20px; border: 2px solid rgba(255,255,255,0.2);">
                    <div style="font-size: 3em; margin-bottom: 15px;">üí°</div>
                    <h3 style="font-size: 1.4em; margin-bottom: 15px;">Smart Tips</h3>
                    <p style="opacity: 0.95; line-height: 1.7;">Get personalized strategies, techniques, and pro tips for each challenge from AI</p>
                </div>

                <div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); padding: 30px; border-radius: 20px; border: 2px solid rgba(255,255,255,0.2);">
                    <div style="font-size: 3em; margin-bottom: 15px;">‚öñÔ∏è</div>
                    <h3 style="font-size: 1.4em; margin-bottom: 15px;">Fair Judging</h3>
                    <p style="opacity: 0.95; line-height: 1.7;">AI assists in creating objective judging criteria and providing initial assessments</p>
                </div>
            </div>
        </div>
    </div>

    <div class="footer">
        <p style="font-size: 1.3em; font-weight: 700;">‚ö° ZENSTARS ‚ö°</p>
        <p>Powered by Open-Source AI ‚Ä¢ Built for Communities</p>
        <p style="margin-top: 30px; opacity: 0.7;">Challenge ‚Ä¢ Compete ‚Ä¢ Celebrate üèÜ</p>
    </div>

    <a href="https://cspdgrit.github.io/chaicheers/" target="_blank" class="floating-btn">‚òï ChaiCheers</a>

    <script>
        // State management
        let currentMode = 'new';
        let currentProvider = 'groq';
        let lastGeneratedContent = '';

        // Load saved API key
        window.addEventListener('DOMContentLoaded', () => {
            const savedKey = localStorage.getItem('zenstars_api_key');
            const savedProvider = localStorage.getItem('zenstars_provider');
            
            if (savedKey) {
                document.getElementById('apiKey').value = savedKey;
            }
            
            if (savedProvider) {
                currentProvider = savedProvider;
                document.querySelectorAll('.provider-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.provider === savedProvider);
                });
            }
        });

        // Provider selection
        document.querySelectorAll('.provider-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                currentProvider = this.dataset.provider;
                document.querySelectorAll('.provider-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                localStorage.setItem('zenstars_provider', currentProvider);
            });
        });

        // Mode selection
        document.querySelectorAll('.option-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                currentMode = this.dataset.mode;
                document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                const titles = {
                    'new': 'Generated Challenge',
                    'variation': 'Challenge Variation',
                    'tips': 'AI Tips & Strategy',
                    'judging': 'Judging Criteria'
                };
                document.getElementById('resultTitle').textContent = titles[currentMode];
            });
        });

        // Save API key
        document.getElementById('apiKey').addEventListener('change', function() {
            if (this.value) {
                localStorage.setItem('zenstars_api_key', this.value);
            }
        });

        // Scroll functions
        function scrollToGenerator() {
            document.getElementById('generator').scrollIntoView({ behavior: 'smooth' });
        }

        function scrollToChallenges() {
            document.getElementById('challenges').scrollIntoView({ behavior: 'smooth' });
        }

        // Build prompt based on mode
        function buildPrompt() {
            const category = document.getElementById('category').value;
            const difficulty = document.getElementById('difficulty').value;
            const duration = document.getElementById('duration').value;
            const requirements = document.getElementById('requirements').value;

            const categoryNames = {
                'art': 'Art & Craft',
                'fitness': 'Fitness',
                'cooking': 'Cooking',
                'home': 'Home & Garden',
                'performance': 'Performance',
                'treasure': 'Treasure Hunt'
            };

            if (currentMode === 'new') {
                return `Generate a creative community challenge with these specifications:
Category: ${categoryNames[category]}
Difficulty: ${difficulty}
Duration: ${duration}
${requirements ? 'Additional Requirements: ' + requirements : ''}

Please provide a well-structured challenge with:
1. Challenge Name (catchy and engaging)
2. Description (clear explanation of what participants need to do)
3. Rules (3-5 clear rules)
4. Judging Criteria (how winners will be selected)
5. Suggested Prize Amount (in INR)
6. Submission Guidelines

Format the response in an easy-to-read way with clear sections. Make it fun, engaging, and suitable for a community event!`;
            } else if (currentMode === 'variation') {
                return `Create a unique variation of a ${categoryNames[category]} challenge with ${difficulty} difficulty that takes ${duration}.
${requirements ? 'Additional Requirements: ' + requirements : ''}

Provide a creative twist on a common ${categoryNames[category]} challenge. Include:
1. Challenge name with the unique twist
2. What makes this variation special
3. How to participate
4. Rules
5. Tips for success

Make it exciting and different from typical challenges!`;
            } else if (currentMode === 'tips') {
                return `Provide expert tips and strategies for a ${categoryNames[category]} challenge at ${difficulty} level that takes ${duration}.
${requirements ? 'Context: ' + requirements : ''}

Include:
1. Preparation Tips (what to do before starting)
2. Execution Strategies (how to perform well)
3. Common Mistakes to Avoid
4. Pro Techniques
5. How to Stand Out from Others

Give practical, actionable advice that will help participants succeed!`;
            } else if (currentMode === 'judging') {
                return `Create comprehensive and fair judging criteria for a ${categoryNames[category]} community challenge at ${difficulty} level.

Provide:
1. Scoring Categories with point values (total 100 points)
2. What judges should look for in each category
3. Tiebreaker criteria
4. Fairness guidelines
5. Clear evaluation rubric

Make it objective, transparent, and easy for judges to follow!`;
            }
        }

        // API call functions
        async function callGroqAPI(prompt, apiKey) {
            const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${apiKey}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    model: 'llama-3.1-70b-versatile',
                    messages: [{ role: 'user', content: prompt }],
                    temperature: 0.7,
                    max_tokens: 2000
                })
            });

            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.error?.message || 'API call failed');
            }

            const data = await response.json();
            return data.choices[0].message.content;
        }

        async function callHuggingFaceAPI(prompt, apiKey) {
            const response = await fetch('https://api-inference.huggingface.co/models/mistralai/Mistral-7B-Instruct-v0.2', {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${apiKey}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    inputs: prompt,
                    parameters: {
                        max_new_tokens: 2000,
                        temperature: 0.7,
                        return_full_text: false
                    }
                })
            });

            if (!response.ok) {
                throw new Error('HuggingFace API call failed');
            }

            const data = await response.json();
            return data[0].generated_text;
        }

        async function callTogetherAPI(prompt, apiKey) {
            const response = await fetch('https://api.together.xyz/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${apiKey}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    model: 'meta-llama/Llama-3-70b-chat-hf',
                    messages: [{ role: 'user', content: prompt }],
                    temperature: 0.7,
                    max_tokens: 2000
                })
            });

            if (!response.ok) {
                throw new Error('Together AI API call failed');
            }

            const data = await response.json();
            return data.choices[0].message.content;
        }

        // Main generate function
        async function generateChallenge() {
            const btn = document.getElementById('generateBtn');
            const resultBox = document.getElementById('resultBox');
            const resultContent = document.getElementById('resultContent');
            const apiKey = document.getElementById('apiKey').value;

            if (!apiKey) {
                resultContent.innerHTML = '<div class="error-note">‚ö†Ô∏è <strong>API Key Required:</strong> Please add your API key above to generate challenges. Get free API keys from the links provided in the settings.</div>';
                resultBox.classList.add('visible');
                return;
            }

            btn.disabled = true;
            btn.innerHTML = '<div class="spinner"></div><span>Generating with AI...</span>';
            resultBox.classList.remove('visible');

            try {
                const prompt = buildPrompt();
                let aiResponse;

                if (currentProvider === 'groq') {
                    aiResponse = await callGroqAPI(prompt, apiKey);
                } else if (currentProvider === 'huggingface') {
                    aiResponse = await callHuggingFaceAPI(prompt, apiKey);
                } else if (currentProvider === 'together') {
                    aiResponse = await callTogetherAPI(prompt, apiKey);
                }

                lastGeneratedContent = aiResponse;
                resultContent.textContent = aiResponse;
                resultBox.classList.add('visible');

                // Add success message
                const successNote = document.createElement('div');
                successNote.className = 'success-note';
                successNote.style.marginTop = '20px';
                successNote.innerHTML = `‚úÖ <strong>Generated Successfully!</strong> Using ${currentProvider.toUpperCase()} API.`;
                resultContent.insertAdjacentElement('afterend', successNote);

            } catch (error) {
                resultContent.innerHTML = `<div class="error-note">‚ùå <strong>Error:</strong> ${error.message}<br><br>
                <strong>Troubleshooting:</strong><br>
                ‚Ä¢ Check if your API key is valid<br>
                ‚Ä¢ Make sure you have credits/quota remaining<br>
                ‚Ä¢ Try a different provider<br>
                ‚Ä¢ Check your internet connection</div>`;
                resultBox.classList.add('visible');
            } finally {
                btn.disabled = false;
                btn.innerHTML = '<span>üöÄ</span><span>Generate with AI</span>';
            }
        }

        // Regenerate with same settings
        function regenerate() {
            generateChallenge();
        }

        // Save challenge
        function saveChallenge() {
            if (!lastGeneratedContent) return;
            
            const blob = new Blob([lastGeneratedContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `zenstars-challenge-${Date.now()}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            
            alert('‚úÖ Challenge saved successfully!');
        }

        // Share challenge
        function shareChallenge() {
            if (!lastGeneratedContent) return;
            
            if (navigator.share) {
                navigator.share({
                    title: 'ZenStars Challenge',
                    text: lastGeneratedContent
                }).catch(() => {
                    copyToClipboard();
                });
            } else {
                copyToClipboard();
            }
        }

        function copyToClipboard() {
            navigator.clipboard.writeText(lastGeneratedContent).then(() => {
                alert('üìã Challenge copied to clipboard!');
            });
        }

        // Generate button click handler
        document.getElementById('generateBtn').addEventListener('click', generateChallenge);

        // Allow Enter key in textarea to trigger generation
        document.getElementById('requirements').addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && e.ctrlKey) {
                generateChallenge();
            }
        });
    </script>
</body>
</html>